UCR_PART = as.character(UCR_PART),
INCIDENT_NUMBER = as.character(INCIDENT_NUMBER),
)
crime <- bind_rows(data_2018, data_2019, data_2020, data_2021, data_2022)
glimpse(crime)
crime <- crime %>%
mutate(
OFFENSE_CODE = as.factor(OFFENSE_CODE),
OFFENSE_CODE_GROUP = as.factor(OFFENSE_CODE_GROUP),
OFFENSE_DESCRIPTION = as.factor(OFFENSE_DESCRIPTION),
DISTRICT = as.factor(DISTRICT)
)
glimpse(crime)
crime <- crime %>%
mutate(OCCURRED_ON_DATE = as.POSIXct(OCCURRED_ON_DATE))
crime <- crime %>%
mutate(
IS_SHOOTING = as.logical(ifelse(SHOOTING == 'Y' |SHOOTING == 1, TRUE, FALSE))
)
table(crime$IS_SHOOTING)
shootings_per_year <- crime %>%
filter(IS_SHOOTING == TRUE) %>%
group_by(YEAR) %>%
summarize(Shootings = n())
crime_totals <- crime %>%
group_by(OFFENSE_CODE_GROUP) %>%
summarize(totals = n())
crime_totals <- crime_totals %>%
filter(OFFENSE_CODE_GROUP != is.na(OFFENSE_CODE_GROUP) & totals != is.na(totals)) %>%
arrange(desc(totals))
crime <- crime %>%
mutate(SHIFT = ifelse(hour(OCCURRED_ON_DATE) >= 0 & hour(OCCURED_ON_DATE) < 8, "Night"),
ifelse(hour(OCCURED_ON_DATE) >= 8 & hour(OCCURED_ON_DATE) < 16, "Day", "Evening")
)
crime <- crime %>%
mutate(SHIFT = ifelse(hour(OCCURRED_ON_DATE) >= 0 & hour(OCCURRED_ON_DATE) < 8, "Night"),
ifelse(hour(OCCURRED_ON_DATE) >= 8 & hour(OCCURRED_ON_DATE) < 16, "Day", "Evening")
)
crime <- crime %>%
mutate(SHIFT = ifelse(hour(OCCURRED_ON_DATE) >= 0 & hour(OCCURRED_ON_DATE) < 8, "Night",
ifelse(hour(OCCURRED_ON_DATE) >= 8 & hour(OCCURRED_ON_DATE) < 16, "Day", "Evening"))
)
table(crime$SHIFT)
View(crime)
crime %>$
group_by(DISTRICT) %>%
summarize(totals = n()) %>%
arrange(desc(totals)) %>%
head(crime, 5)
crime %>%
group_by(DISTRICT) %>%
summarize(totals = n()) %>%
arrange(desc(totals)) %>%
head(crime, 5)
crime %>%
group_by(DISTRICT) %>%
filter(DISTRICT != is.na(DISTRICT)) %>%
summarize(totals = n()) %>%
arrange(desc(totals)) %>%
head(crime, 5)
crime %>%
filter(DISTRICT != is.na(DISTRICT)) %>%
group_by(DISTRICT) %>%
summarize(totals = n()) %>%
arrange(desc(totals)) %>%
head(crime, 5)
crime %>%
filter(DISTRICT != is.na(DISTRICT)) %>%
group_by(DISTRICT) %>%
summarize(totals = n()) %>%
arrange(desc(totals)) %>%
head(5)
crime %>%
filter(MONTH != is.na(MONTH)) %>%
group_by(MONTH) %>%
summarize(totals = n()) %>%
arrange(desc(totals)) %>%
head(5)
crime %>%
filter(OFFENSE_DESCRIPTION == 'AUTO THEFT') %>%
order_by(DISTRICT) %>%
summarize(max_incidents = max())
crime %>%
filter(OFFENSE_DESCRIPTION == 'AUTO THEFT') %>%
group_by(DISTRICT) %>%
summarize(max_incidents = max())
crime %>%
filter(OFFENSE_DESCRIPTION == 'AUTO THEFT') %>%
group_by(DISTRICT) %>%
summarize(auto_theft_count = n()) %>%
arrange(desc(auto_theft_count)) %>%
head(1)
crime %>%
filter(IS_SHOOTING != FALSE & IS_SHOOTING != NA) %>%
group_by(DISTRICT) %>%
summarize(shootings = n())
crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(shootings = n())
crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT, YEAR) %>%
summarize(shootings = n())
crime %>%
filter(OFFENSE_DESCRIPTION == 'AUTO THEFT') %>%
group_by(DISTRICT) %>%
summarize(auto_theft_count = n()) %>%
slice_max(auto_theft_count, n = 1)
crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(shootings = n())
crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
ungroup() %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n())
district_totals <- crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n())
district_yearly <- crime %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n())
district_totals <- crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n())
district_yearly <- crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n())
district_totals <- crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
slice_max(district_shootings, 1)
district_totals <- crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
slice_max(district_shootings, n = 1)
district_yearly <- crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n())
View(district_totals)
View(district_yearly)
district_totals <- crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
slice_max(district_shootings, n = 1)
district_yearly <- crime %>%
filter(IS_SHOOTING != FALSE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n(), .groups = "drop") %>%
group_by(YEAR) %>%
slice_max(district_year_shootings, n = 1)
district_totals <- crime %>%
filter(IS_SHOOTING == TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
slice_max(district_shootings, n = 1)
district_yearly <- crime %>%
filter(IS_SHOOTING ==TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n(), .groups = "drop") %>%
group_by(YEAR) %>%
slice_max(district_year_shootings, n = 1)
View(data_2018)
View(data_2020)
View(data_2021)
View(district_totals)
View(district_totals)
district_totals <- crime %>%
filter(IS_SHOOTING == TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
slice_max(district_shootings, n = 1)
district_yearly <- crime %>%
filter(IS_SHOOTING ==TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n(), .groups = "drop") %>%
group_by(YEAR)
View(district_yearly)
district_totals <- crime %>%
filter(IS_SHOOTING == TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
slice_max(district_shootings, n = 1)
district_yearly <- crime %>%
filter(IS_SHOOTING ==TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n())
View(district_yearly)
district_totals <- crime %>%
filter(IS_SHOOTING == TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
slice_max(district_shootings, n = 1)
district_yearly <- crime %>%
filter(IS_SHOOTING ==TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n()) %>%
slice_max(district_year_shootings, n = 1)
district_totals <- crime %>%
filter(IS_SHOOTING == TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
slice_max(district_shootings, n = 1)
district_yearly <- crime %>%
filter(IS_SHOOTING ==TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n(), .groups = "drop") %>%
group_by(YEAR) %>%
slice_max(district_year_shootings, n = 1, with_ties = FALSE)
View(crime)
district_crime <- function(dist, code) {
crime %>%
filter(DISTRICT == dist & OFFENSE_CODE == code) %>%
group_by(YEAR) %>%
summarize(total = n()) %>%
setNames(c("YEAR", as.character(code)))
}
district_crime <- function(dist, code) {
crime %>%
filter(DISTRICT == dist & OFFENSE_CODE == code) %>%
group_by(YEAR) %>%
summarize(total = n()) %>%
setNames(c("YEAR", as.character(code)))
}
district_crime("D4", "801")
crime %>%
ggplot(aex(x = HOUR)) +
geom_histogram() +
ggtitle("Distribution of Crime Incidents by Hour") +
xlab("Hour of the Day (0-23)")
crime %>%
ggplot(aes(x = HOUR)) +
geom_histogram() +
ggtitle("Distribution of Crime Incidents by Hour") +
xlab("Hour of the Day (0-23)")
crime %>%
ggplot(aes(x = HOUR)) +
geom_histogram(bins = 30) +
ggtitle("Distribution of Crime Incidents by Hour") +
xlab("Hour of the Day (0-23)")
crime %>%
ggplot(aes(x = DAY_OF_WEEK)) +
geom_bar() +
ylab("Number of Incidents") +
xlab("Day of the Week") +
ggtitle("Total Number of Incidents Per Year")
day_order <- c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday")
crime %>%
mutate(DAY_OF_WEEK = factor(DAY_OF_WEEK, levels = day_order)) %>%
ggplot(aes(x = DAY_OF_WEEK)) +
geom_bar() +
ylab("Number of Incidents") +
xlab("Day of the Week") +
ggtitle("Total Number of Incidents Per Year")
crime %>%
ggplot(aes(x = MONTH, y = IS_SHOOTING)) +
geom_line()
crime %>%
group_by(MONTH) %>%
summarize(shooting_count = sum(IS_SHOOTING, na.rm = TRUE)) %>%
ggplot(aes(x = MONTH, y = shooting_count)) +
geom_line()
library(dplyr)
library(lubridate)
library(tidyverse)
library(readr)
data_2018 <- read_csv("2018.csv") %>%
mutate(INCIDENT_NUMBER = as.character(INCIDENT_NUMBER),
OFFENSE_CODE = as.numeric(OFFENSE_CODE),
REPORTING_AREA = as.numeric(REPORTING_AREA),
SHOOTING = as.numeric(SHOOTING)
)
data_2019 <-read_csv("2019.csv") %>%
mutate(INCIDENT_NUMBER = as.character(INCIDENT_NUMBER),
OFFENSE_CODE_GROUP = as.character(OFFENSE_CODE_GROUP),
UCR_PART = as.character(UCR_PART)
)
data_2020 <- read_csv("2020.csv") %>%
mutate(OFFENSE_CODE_GROUP = as.character(OFFENSE_CODE_GROUP),
UCR_PART = as.character(UCR_PART),
INCIDENT_NUMBER = as.character(INCIDENT_NUMBER),
)
data_2021 <- read_csv("2021.csv") %>%
mutate(OFFENSE_CODE_GROUP = as.character(OFFENSE_CODE_GROUP),
UCR_PART = as.character(UCR_PART),
INCIDENT_NUMBER = as.character(INCIDENT_NUMBER),
)
data_2022 <- read_csv("2022.csv") %>%
mutate(OFFENSE_CODE_GROUP = as.character(OFFENSE_CODE_GROUP),
UCR_PART = as.character(UCR_PART),
INCIDENT_NUMBER = as.character(INCIDENT_NUMBER),
)
crime <- bind_rows(data_2018, data_2019, data_2020, data_2021, data_2022)
glimpse(crime)
crime <- crime %>%
mutate(
OFFENSE_CODE = as.factor(OFFENSE_CODE),
OFFENSE_CODE_GROUP = as.factor(OFFENSE_CODE_GROUP),
OFFENSE_DESCRIPTION = as.factor(OFFENSE_DESCRIPTION),
DISTRICT = as.factor(DISTRICT)
)
glimpse(crime)
crime <- crime %>%
mutate(OCCURRED_ON_DATE = as.POSIXct(OCCURRED_ON_DATE))
crime <- crime %>%
mutate(
IS_SHOOTING = as.logical(ifelse(SHOOTING == 'Y' |SHOOTING == 1, TRUE, FALSE))
)
table(crime$IS_SHOOTING)
shootings_per_year <- crime %>%
filter(IS_SHOOTING == TRUE) %>%
group_by(YEAR) %>%
summarize(Shootings = n())
crime_totals <- crime %>%
group_by(OFFENSE_CODE_GROUP) %>%
summarize(totals = n())
crime_totals <- crime_totals %>%
filter(OFFENSE_CODE_GROUP != is.na(OFFENSE_CODE_GROUP) & totals != is.na(totals)) %>%
arrange(desc(totals))
crime <- crime %>%
mutate(SHIFT = ifelse(hour(OCCURRED_ON_DATE) >= 0 & hour(OCCURRED_ON_DATE) < 8, "Night",
ifelse(hour(OCCURRED_ON_DATE) >= 8 & hour(OCCURRED_ON_DATE) < 16, "Day", "Evening"))
)
table(crime$SHIFT)
crime %>%
filter(DISTRICT != is.na(DISTRICT)) %>%
group_by(DISTRICT) %>%
summarize(totals = n()) %>%
arrange(desc(totals)) %>%
head(5)
crime %>%
filter(MONTH != is.na(MONTH)) %>%
group_by(MONTH) %>%
summarize(totals = n()) %>%
arrange(desc(totals)) %>%
head(5)
crime %>%
filter(OFFENSE_DESCRIPTION == 'AUTO THEFT') %>%
group_by(DISTRICT) %>%
summarize(auto_theft_count = n()) %>%
slice_max(auto_theft_count, n = 1)
district_totals <- crime %>%
filter(IS_SHOOTING == TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT) %>%
summarize(district_shootings = n()) %>%
slice_max(district_shootings, n = 1)
district_yearly <- crime %>%
filter(IS_SHOOTING ==TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n(), .groups = "drop") %>%
group_by(YEAR) %>%
slice_max(district_year_shootings, n = 1, with_ties = FALSE)
district_crime <- function(dist, code) {
crime %>%
filter(DISTRICT == dist & OFFENSE_CODE == code) %>%
group_by(YEAR) %>%
summarize(total = n()) %>%
setNames(c("YEAR", as.character(code)))
}
district_crime <- function(dist, codes) {
crime %>%
filter(DISTRICT == dist & OFFENSE_CODE %in% codes) %>%
group_by(YEAR) %>%
summarize(total = n()) %>%
setNames(c("YEAR", "Total"))
}
crime %>%
ggplot(aes(x = HOUR)) +
geom_histogram(bins = 30) +
ggtitle("Distribution of Crime Incidents by Hour") +
xlab("Hour of the Day (0-23)")
day_order <- c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday")
crime %>%
mutate(DAY_OF_WEEK = factor(DAY_OF_WEEK, levels = day_order)) %>%
ggplot(aes(x = DAY_OF_WEEK)) +
geom_bar() +
ylab("Number of Incidents") +
xlab("Day of the Week") +
ggtitle("Total Number of Incidents Per Year")
# Plot: Monthly Shooting Trends
crime %>%
group_by(MONTH) %>%
summarize(shooting_count = sum(IS_SHOOTING, na.rm = TRUE)) %>%
ggplot(aes(x = MONTH, y = shooting_count)) +
geom_line()
source("~/Police_data.R")
list.files()
setwd("~/")
getwd()
source("~/Police_data.R")
source("~/Police_data.R")
source("~/Police_data.R")
source("~/Police_data.R")
source("~/Police_data.R")
source("~/Police_data.R")
source("~/Police_data.R")
data_2018 <- read_csv("2018.csv") %>%
mutate(INCIDENT_NUMBER = as.character(INCIDENT_NUMBER),
OFFENSE_CODE = as.numeric(OFFENSE_CODE),
REPORTING_AREA = as.numeric(REPORTING_AREA),
SHOOTING = as.numeric(SHOOTING)
)
source("~/Police_data.R")
setwd("~/")
source("~/Police_data.R")
source("~/Police_data.R")
library(dplyr)
library(lubridate)
library(tidyverse)
library(readr)
data_2018 <- read_csv("2018.csv") %>%
mutate(INCIDENT_NUMBER = as.character(INCIDENT_NUMBER),
OFFENSE_CODE = as.numeric(OFFENSE_CODE),
REPORTING_AREA = as.numeric(REPORTING_AREA),
SHOOTING = as.numeric(SHOOTING)
)
library(dplyr)
library(lubridate)
library(tidyverse)
library(readr)
setwd("~/")
data_2018 <- read_csv("2018.csv") %>%
mutate(INCIDENT_NUMBER = as.character(INCIDENT_NUMBER),
OFFENSE_CODE = as.numeric(OFFENSE_CODE),
REPORTING_AREA = as.numeric(REPORTING_AREA),
SHOOTING = as.numeric(SHOOTING)
)
source("~/Police_data.R")
source("~/.active-rstudio-document")
setwd("~/")
source("~/Police_data.R")
source("~/Police_data.R")
getwd()
source("~/Police_data.R")
View(data_2018)
source("~/Documents/JulissaR_project/Crime_analysis.R")
setwd("~/Documents/JulissaR_project")
source("~/Documents/JulissaR_project/Crime_analysis.R")
glimpse(crime)
# Summarizing total incidents by offense code group
crime_totals <- crime %>%
group_by(OFFENSE_CODE_GROUP) %>%
summarize(totals = n())
crime_totals
crime_totals
# Displaying the table of SHIFT categories
table(crime$SHIFT)
# ------------------------------------------------------------------------------
# Grouping and Summarizing by District
# ------------------------------------------------------------------------------
# Summarizing the number of crimes per district (top 5)
crime %>%
filter(DISTRICT != is.na(DISTRICT)) %>%
group_by(DISTRICT) %>%
summarize(totals = n()) %>%
arrange(desc(totals)) %>%
head(5)
# ------------------------------------------------------------------------------
# Analyzing Auto Theft Incidents by District
# ------------------------------------------------------------------------------
# Summarizing the number of auto thefts by district and finding the district with most auto thefts
crime %>%
filter(OFFENSE_DESCRIPTION == 'AUTO THEFT') %>%
group_by(DISTRICT) %>%
summarize(auto_theft_count = n()) %>%
slice_max(auto_theft_count, n = 1)
# ------------------------------------------------------------------------------
# Yearly Shootings by District
# ------------------------------------------------------------------------------
# Summarizing shootings by district and year, then finding the district with the most shootings each year
district_yearly <- crime %>%
filter(IS_SHOOTING ==TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n(), .groups = "drop") %>%
group_by(YEAR) %>%
slice_max(district_year_shootings, n = 1, with_ties = FALSE)
# ------------------------------------------------------------------------------
# Yearly Shootings by District
# ------------------------------------------------------------------------------
# Summarizing shootings by district and year, then finding the district with the most shootings each year
district_yearly <- crime %>%
filter(IS_SHOOTING ==TRUE & !is.na(IS_SHOOTING)) %>%
group_by(DISTRICT,YEAR) %>%
summarize(district_year_shootings = n(), .groups = "drop") %>%
group_by(YEAR) %>%
slice_max(district_year_shootings, n = 1, with_ties = FALSE)
district_yearly
district_totals
View(data_2018)
# ------------------------------------------------------------------------------
# Visualizing the Data
# ------------------------------------------------------------------------------
# Plot: Distribution of Crime Incidents by Hour of Day
crime %>%
ggplot(aes(x = HOUR)) +
geom_histogram(bins = 30) +
ggtitle("Distribution of Crime Incidents by Hour") +
xlab("Hour of the Day (0-23)")
# Displaying the table of SHIFT categories
table(crime$SHIFT)
source("~/Documents/JulissaR_project/Crime_analysis.R")
